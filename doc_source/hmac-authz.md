# Controlling access to HMAC KMS keys<a name="hmac-authz"></a>

To control access to an HMAC KMS key, you use a [key policy](key-policies.md), which is required for every KMS key\. You can also use [IAM policies](iam-policies.md) and [grants](grants.md)\. 

The [default key policy](key-policy-default.md) for HMAC keys created in the AWS KMS console gives key users permission to call the [https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateMac.html](https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateMac.html) and [https://docs.aws.amazon.com/kms/latest/APIReference/API_VerifyMac.html](https://docs.aws.amazon.com/kms/latest/APIReference/API_VerifyMac.html) operations\. However, it does not include the [key policy statement](key-policy-default.md#key-policy-service-integration) designed for using grants with AWS services\. If you create HMAC keys by using the [https://docs.aws.amazon.com/kms/latest/APIReference/API_CreateKey.html](https://docs.aws.amazon.com/kms/latest/APIReference/API_CreateKey.html) operation, you must specify these permissions in the key policy or an IAM policy\.

You can use [AWS global condition keys](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#AvailableKeys) and AWS KMS condition keys to refine and limit permissions to HMAC keys\. For example, you can use the [`kms:ResourceAliases`](conditions-kms.md#conditions-kms-resource-aliases) condition key to control access to AWS KMS operations based on the aliases associated with an HMAC key\. The following AWS KMS policy conditions are useful for policies on HMAC keys\. 
+ Use a [`kms:MacAlgorithm`](conditions-kms.md#conditions-kms-mac-algorithm) condition key to limit the algorithms that the principals can request when they call the [https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateMac.html](https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateMac.html) and [https://docs.aws.amazon.com/kms/latest/APIReference/API_VerifyMac.html](https://docs.aws.amazon.com/kms/latest/APIReference/API_VerifyMac.html) operations\. For example, you can allow principals to call the `GenerateMac` operations but only when the MAC algorithm in the request is `HMAC_SHA_384`\.
+ Use a [`kms:KeySpec`](conditions-kms.md#conditions-kms-key-spec) condition key to allow or prevent principals from creating certain types of HMAC keys\. For example, to allow principals to create only HMAC keys, you can allow the [CreateKey](https://docs.aws.amazon.com/kms/latest/APIReference/API_CreateKey.html) operation, but use the `kms:KeySpec` condition to allow only keys with an `HMAC_384` key spec\.

  You can also use the `kms:KeySpec` condition key to control access to other operations on a KMS key based on the key spec of the key\. For example, you can allow principals to schedule and cancel key deletion only on KMS keys with an `HMAC_256` key spec\.
+ Use the [`kms:KeyUsage`](conditions-kms.md#conditions-kms-key-usage) condition key to allow or prevent principals from creating any HMAC keys\. For example, to allow principals to create only HMAC keys, you can allow the [CreateKey](https://docs.aws.amazon.com/kms/latest/APIReference/API_CreateKey.html) operation, but use the `kms:KeyUsage` condition to allow only keys with a `GENERATE_VERIFY_MAC` key usage\.

  You can also use the `kms:KeyUsage` condition key to control access to other operations on a KMS key based on the key usage of the key\. For example, you can allow principals to enable and disable only on KMS keys with a `GENERATE_VERIFY_MAC` key usage\.

You can also create grants for [https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateMac.html](https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateMac.html) and [https://docs.aws.amazon.com/kms/latest/APIReference/API_VerifyMac.html](https://docs.aws.amazon.com/kms/latest/APIReference/API_VerifyMac.html) operations, which are [grant operations](grants.md#terms-grant-operations)\. However, you cannot use an encryption context [grant constraint](create-grant-overview.md#grant-constraints) in a grant for an HMAC key\. The HMAC tag format does not support encryption context values\.